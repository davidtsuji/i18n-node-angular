/*! i18n-node-angular 2014-06-20 12:21:10 */
!function(){"use strict";var a=angular.module("i18n",[]);a.directive("i18nLocale",["i18n","$rootScope",function(a,b){return{restrict:"A",link:function(c,d,e){e.$observe("i18nLocale",function(b){a.init(b)}),b.$watch("i18nLocale",function(b,c){b&&b!=c&&a.init(b)})}}}]),a.factory("i18n",function(a,b,c){var d=function(){this._localeLoadedDeferred=c.defer(),this._deferredStack=[],this.loaded=!1,this.init=function(d){if(d!=this.userLanguage){this._localeLoadedDeferred&&this._deferredStack.push(this._localeLoadedDeferred),this._localeLoadedDeferred=c.defer(),this.loaded=!1,this.userLanguage=d;var e=this;b({method:"get",url:"/i18n/"+d,cache:!0}).success(function(b){for(a.i18n=b,e.loaded=!0,e._localeLoadedDeferred.resolve(a.i18n);e._deferredStack.length;)e._deferredStack.pop().resolve(a.i18n)})}return this._localeLoadedDeferred.promise},this.i18n=function(){var a=c.defer(),b=this;return this.ensureLocaleIsLoaded().then(function(){a.resolve(b)}),a.promise},this.ensureLocaleIsLoaded=function(){return this._localeLoadedDeferred.promise},this.__=function(c){if(!a.i18n)return c;var d=a.i18n[c];return d||(d=c,a.i18n[c]=d,b.get("/i18n/"+this.userLanguage+"/"+encodeURIComponent(c)).success(function(b){a.i18n[c]=b})),arguments.length>1&&"function"==typeof vsprintf&&(d=vsprintf(d,Array.prototype.slice.call(arguments,1))),d},this.__n=function(c,d,e){if(!a.i18n)return d;var f=a.i18n[d];return f||(f={one:d,other:e},a.i18n[d]=f,b.get("/i18n/"+this.userLanguage+"/"+encodeURIComponent(d)+"?plural="+encodeURIComponent(e)+"&count="+encodeURIComponent(c)).success(function(b){a.i18n[d]=b})),f=1==c?f.one:f.other,"function"==typeof vsprintf&&(f=vsprintf(f,[c])),f}};return new d}),a.filter("i18n",["i18n",function(a){function b(a){return!isNaN(parseFloat(a))&&isFinite(a)}return function(c){return b(c)?a.__n.apply(a,arguments):a.__.apply(a,arguments)}}])}();